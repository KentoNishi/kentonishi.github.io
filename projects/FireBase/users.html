<script src="https://www.gstatic.com/firebasejs/5.0.2/firebase.js"></script>
<script src="https://apis.google.com/js/platform.js" async defer></script>
<meta name="google-signin-client_id" content="939148943087-s9e16hsm6dhal5v0em44ndspa4bo7dcd.apps.googleusercontent.com">
<div class="g-signin2" data-onsuccess="onSignIn"></div>

<script>
  
  var email="";
  var password="";
  function onSignIn(googleUser) {
    var profile = googleUser.getBasicProfile();
    console.log('ID: ' + profile.getId()); // Do not send to your backend! Use an ID token instead.
    console.log('Name: ' + profile.getName());
    console.log('Image URL: ' + profile.getImageUrl());
    console.log('Email: ' + profile.getEmail()); // This is null if the 'email' scope is not present.
    email=profile.getEmail();
    password=profile.getId();
  }
  
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyB5XNbaaKee9GqQ74FjHPHam055_FqrVf4",
    authDomain: "kento-nishi-gi-1525841644617.firebaseapp.com",
    databaseURL: "https://kento-nishi-gi-1525841644617.firebaseio.com",
    projectId: "kento-nishi---gi-1525841644617",
    storageBucket: "kento-nishi---gi-1525841644617.appspot.com",
    messagingSenderId: "939148943087"
  };
  firebase.initializeApp(config);
  
  var auth=firebase.auth();

  function login(){
    auth.signInWithEmailAndPassword(email, password).catch(function(error) {
      auth.createUserWithEmailAndPassword(email, password);
    });
  }
  
  function upload(){
    var mystring = document.querySelectorAll("#input")[0].value;
    var myblob = new Blob([mystring], {
    type: 'text/plain'
    });
    var file=myblob;
    var storageRef=firebase.storage().ref("User-Data/"+email.replace(/[^a-zA-Z0-9]/g,'')+'.txt');
    storageRef.put(file);
    
    storageRef.getDownloadURL().then(function(url) {
     $.get("https://firebasestorage.googleapis.com/v0/b/kento-nishi---gi-1525841644617.appspot.com/o/User-Data%2Fkentosuper24gmailcom.txt?alt=media&token=9ab41914-8b88-4e3a-8356-5e8d53d150e4", function(data, status){
                alert("Data: " + data + "\nStatus: " + status);
            });
        }).catch(function(error) {
          console.log("ERROR!");
          // Handle any errors
        });

      }
 
</script>

<input id="input" />

<button onclick="upload()">SAVE</button>

